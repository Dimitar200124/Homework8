# Homework8_Polikarpov_Dmitry
Исследование XSS уязвимостей Google Gruyere при помощи Scapy

ВЫПОЛНЕННЫЕ ДЕЙСТВИЯ:

1.Установлен Scapy
2. Создан скрипт analyzer3.py, позволяющий перехватывать http траффик, записывать дамп и сохранять результаты перехвата в json-файл
3. Проверена работоспособность скрипта, проанализированы полученные ответы
4. Открыт сайт Google Gruyere в браузере, выполнена регистрация, вход в аккаунт
5. Скрипт запущен, начат перехват tcp-пакетов
6. Проведен поиск и эксплуатация XSS-уязвимостей на сайте
7. Сохранён дамп траффика
8. В дампе найдены следы XSS-атаки

РЕЗУЛЬТАТЫ:
Перехвачено запрсов: 33
Перехвачено ответов: 33
Всего пакетов: 418
Порт: 80 (HTTP)

АНАЛИЗ ТРАФФИКА:
Источник (мой ПК): 192.168.1.46
Google Gruyere: 142.250.180.84

ТИПЫ ПАКЕТОВ:
Исходящие (src -> dst) запросы клиента к серверу Google Gruyere
Входящие (dst -> src) ответы сервера Google Gruyere клиенту

ВЫПОЛНЕННЫЕ XSS-АТАКИ:
1. XSS через сниппет
PAYLOAD: <script> alert('XSS')</script>
Результат: JS код не выполнился, выведена надпись alert('XSS') в тексте нового сниппета
Статус: не является уязвимостью
2. XSS через поле настроек цвета по умолчанию
PAYLOAD: <script> alert('XSS')</script>
Результат: JS код не выполнился, выведена надпись alert('XSS') в тексте настроек
Статус: не является уязвимостью
3. XSS через поле загрузки изображения в настройках профиля
PAYLOAD: <img src="" onerror="alert('XSS')">
Результат: JS код не выполнился, выведена неполная надпись payload в графе загрузки изображения (слишком много символов)
Статус: не является уязвимостью
5. XSS через URL
PAYLOAD: http://google-gruyere.appspot.com/661171057624734276359203322415253240810/<script> alert('XSS')</script>
Результат: JS код выполнился, появилось alert-уведомление с надписью XSS (см. скриншот)
Статус: REFLECTED XSS (CWE-79)

ДОПОЛНИТЕЛЬНО:
Обнаружена критическая архитектурная ошибка - во время входа в аккаунт пароль пользователя передаётся в URL (см. gruyere_traffic.json)
Следовательно, пароль может хранится в истории браузера, логах веб-сервера, а также кэшироваться через прокси 
Статус: CWE-598 (Credentials in URL)

ВЫВОДЫ:
1. Успешно перехвачен сетевой траффик Google Gruyere
2. Использован протокол HTTP
3. Пакеты сохранены в файл gruyere_traffic.json, дамп траффика - в файл gruyere.pcap
4. Проанализирована структура TCP-пакетов
5. Обнаружены две XSS-уязвимости
